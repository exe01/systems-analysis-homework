Обоснование системы
===================

Event Storming
--------------

Схема - https://miro.com/app/board/uXjVK7erPVo=/?moveToWidget=3458764592539347689&cot=14

Обоснование контекстов:
- Сайт с услугами - регистрация, выбор услуги и запрос помощи визуально проходят в одном контуре веб модуля. 
Поэтому решил объединить в один контекст.
- Выполнение заданий - подумал над отдельным модулем по управлению заданиями, так как все процессы оперируют 
одной сущностью - заданием. Визуально всплывает приложение, где воркеры видят назначенное на них задание, имеют форму 
загрузки документов и действия по началу выполнения задания.
- Матчинг воркеров и клиентов - может в дальнейшем сильно усложниться, поэтому решил выделить в отдельный контекст, хоть
и сейчас матчинг происходит рандомно.
- Найм воркеров - все процессы связаны с приемом на работу от него нам нужен только результат сущности готового к работе
воркера. В требованиях было условие гибкости отсева котов
- Упаковка расходников - процессы работают с физическими объектами, все действия нужны для снабжения воркера.
- Изучение качества выполненных работ - все действия нужны только для анализа заданий и не привносят обратно в систему 
новых событий/данных.
- Ставки - изолированный действия по ставкам, которые будут в начале ручными, легко разом отказаться от него.
- Биллинг - все действия связанны с финансовыми операциями.

Модель данных
-------------

Схема - https://miro.com/app/board/uXjVK7erPVo=/?moveToWidget=3458764592539766134&cot=14

Общая модель коммуникаций
-------------------------

Схема - https://miro.com/app/board/uXjVK7erPVo=/?moveToWidget=3458764592539766286&cot=14

Реализация проекта
------------------

Условия:
- Низкий TTM
- Маленькая нагрузка
- Важна гибкость в отсеве котов (найм) и изменение текущих фич
- Деньги не критичны. Команда будет собрана после анализа

ТТМ:
- Микросервисы - Изначально можно распараллелить разработку. Но будут сложности с инфраструктурой. Легко менять технологии
под нужные задачи в каждом из сервисов, либо отказываться от ненужных сервисов. Можно гибко настраивать сложные, часто
меняющиеся сервисы. Если завалят сервис по найму котов будет не критично, так как другие сервисы будут жить.
- Монолит - Легко настроить инфраструктуру. Нужно договориться изначально о модульности в проекте. Не получится выбирать
разные подходы к разработке (где-то использовать DDD, где-то наклепать CRUD с фреймворком админкой) нужно придерживаться
везде одинакового подхода.

Перфоманс:
- Микросервисы - не так быстро будет отвечать, как монолит. Но это не критично, так как низкая нагрузка.
- Монолит - быстро будет отвечать, на базу нагрузка небольшая исходя из требований (10 заказов в день и 100 клиентов. 
Воркеров будет около 20 котов.)

Стоимость:
- Микросервисы - 8 микросервисов - каждому нужна бд и инфраструктура с развертыванием.
- Монолит - низкая 

Как элементы будут общаться между собой:
- Микросервисы - Очередь для выполненных задач у сервиса "Задание в конечном статусе", остальное большую часть через http. 
- Монолит - Кроны + Бекграунд процессы 


Итоговое сравнение:

Связанность:
- Микросервисы - не так много вызовов между сервисами, но есть проблема с синхронизацией информации о заданиях/клиентах/воркерах. Скорость ответа не важна. (+-)
- Монолит - высокая скорость ответа, но это не критично (+-)

Инфраструктура:
- Микросервисы - инфраструктура стоит дорого. Но деньги не критичны (+-)
- Монолит - дешевле (+-)

ТТМ:
- Микросервисы - лучше паралелятся, легче вносить изменения в отдельные сервисы, регулируемая сложность. (+)
- Монолит - вначале все будет быстро, но с усложнением системы все тяжелее будет поддерживать. (-)

Мой выбор - Микросервисы

Спорные места
-------------

- Не реализована защита от ддоса
- Не продуманы условия в биллинге (не хватка денег у клиента, отрицательный баланс у воркера)
- Tasks streaming communications дублируют domain event "Задание в конечном статусе"
- От контекста "Выполнение заданий" зависят все остальные модули. Не понятно на сколько это критично.
